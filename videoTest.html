<!DOCTYPE html>
<html lang="en" >
<head>
    <meta charset="UTF-8" >
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" >
    <meta name="format-detection" content="telephone=no" >
    <meta name="screen-orientation" content="portrait" >
    <meta name="x5-orientation" content="portrait" >
    <meta name="full-screen" content="yes" >
    <meta name="x5-fullscreen" content="true" >
    <meta name="browsermode" content="application" >
    <meta name="x5-page-mode" content="app" >
    <title>视频poster测试</title>
</head>
<body>
<video class="video" controls="controls" poster="">
    <source src="1.mp4" >
</video>
<video class="video" controls="controls" poster="">
    <source src="2.mp4" >
</video>


<!--video截图遍历到对应的video的poster封面图上-->
<script type="text/javascript">
    // 设置poster属性
    const setPoster = function(video, scale = 0.8) {
        video.addEventListener('loadeddata', function(event) {
            // 拿到图片
            let canvas = document.createElement('canvas');
            canvas.width = video.videoWidth * scale;
            canvas.height = video.videoHeight * scale;
            canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
            let src = canvas.toDataURL('image/png');
            // 显示在dom，测试用
            (function(flag = true) {
                if (!flag) {return;}
                let img = document.createElement('img');
                img.src = src;
                document.body.appendChild(img);
            })(0);
            // 设置属性
            video.setAttribute('poster', src);
        });
    };
    let videos = document.querySelectorAll('video');
    videos.forEach((video) => {
        setPoster(video);
    });

</script>
